<div class="max-w-2xl mx-auto px-6 lg:px-8 py-16">
  <!-- Header -->
  <div class="mb-12">
    <h1 class="text-3xl font-light">Settings</h1>
    <p class="text-sm text-neutral-500 mt-2">Manage your account and API integrations.</p>
  </div>

  <!-- Account Info -->
  <div class="mb-12 p-6 bg-neutral-50 rounded-xl">
    <h2 class="text-sm font-medium uppercase tracking-wider text-neutral-400 mb-4">Account</h2>
    <div class="space-y-3 text-sm">
      <div class="flex justify-between">
        <span class="text-neutral-500">Email</span>
        <span class="font-medium"><%= current_user.email %></span>
      </div>
      <div class="flex justify-between">
        <span class="text-neutral-500">Role</span>
        <span class="font-medium capitalize"><%= current_user.role %></span>
      </div>
      <% if current_user.seller? && current_user.seller_profile %>
        <div class="flex justify-between">
          <span class="text-neutral-500">Store</span>
          <span class="font-medium"><%= current_user.seller_profile.store_name %></span>
        </div>
      <% end %>
    </div>
  </div>

  <!-- API Keys Section -->
  <div class="border border-neutral-200 rounded-xl overflow-hidden">
    <div class="p-6 border-b border-neutral-100">
      <h2 class="text-lg font-medium">API Keys</h2>
      <p class="text-sm text-neutral-500 mt-1">Connect your own AI services for enhanced MVT validation.</p>
    </div>

    <%= form_with model: current_user, url: settings_path, method: :patch, class: "p-6 space-y-6" do |f| %>
      <% if current_user.errors.any? %>
        <div class="p-4 bg-red-50 border border-red-100 rounded-lg">
          <p class="text-sm text-red-600">
            <% current_user.errors.full_messages.each do |message| %>
              <%= message %><br>
            <% end %>
          </p>
        </div>
      <% end %>

      <!-- Gemini API Key -->
      <div>
        <div class="flex items-center justify-between mb-2">
          <%= f.label :gemini_api_key, "Gemini API Key", class: "block text-xs text-neutral-500 uppercase tracking-wider" %>
          <% if current_user.has_gemini_key? %>
            <span class="text-xs text-green-600 flex items-center gap-1">
              <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
              </svg>
              Connected
            </span>
          <% end %>
        </div>
        <%= f.password_field :gemini_api_key,
            placeholder: current_user.has_gemini_key? ? "••••••••••••••••" : "AIzaSy...",
            class: "w-full px-4 py-3 border border-neutral-200 rounded-lg focus:border-neutral-900 focus:ring-0 text-sm placeholder-neutral-300 transition-colors" %>
        <p class="text-xs text-neutral-400 mt-2">
          Get your API key from
          <%= link_to "Google AI Studio", "https://aistudio.google.com/apikey", target: "_blank", class: "underline hover:text-neutral-900" %>.
          Your key is encrypted and stored securely.
        </p>
      </div>

      <!-- Benefits -->
      <div class="p-4 bg-neutral-50 rounded-lg">
        <p class="text-sm font-medium mb-2">Why connect Gemini?</p>
        <ul class="text-xs text-neutral-500 space-y-1">
          <li class="flex items-center gap-2">
            <span class="text-green-600">+</span>
            AI-powered deep content analysis for MVT validation
          </li>
          <li class="flex items-center gap-2">
            <span class="text-green-600">+</span>
            More accurate detection of hidden assumptions
          </li>
          <li class="flex items-center gap-2">
            <span class="text-green-600">+</span>
            Detailed feedback and recommendations
          </li>
        </ul>
      </div>

      <!-- Submit -->
      <div class="flex items-center gap-4">
        <%= f.submit "Save settings",
            class: "px-6 py-3 bg-neutral-900 text-white text-sm font-medium rounded-full hover:bg-neutral-700 transition-colors cursor-pointer" %>
        <% if current_user.has_gemini_key? %>
          <%= link_to "Remove key",
              settings_path(user: { gemini_api_key: "" }),
              data: { turbo_method: :patch, turbo_confirm: "Are you sure you want to remove your Gemini API key?" },
              class: "text-sm text-red-600 hover:underline" %>
        <% end %>
      </div>
    <% end %>
  </div>

  <!-- Danger Zone -->
  <div class="mt-12 pt-12 border-t border-neutral-100">
    <h2 class="text-sm font-medium uppercase tracking-wider text-red-600 mb-4">Danger Zone</h2>
    <%= link_to edit_user_registration_path, class: "text-sm text-neutral-500 hover:text-neutral-900" do %>
      Change password →
    <% end %>
  </div>
</div>
